<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Add Card Modal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f0f0;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        #log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
        }
        .log-success { color: #28a745; }
        .log-error { color: #dc3545; }
        .log-info { color: #17a2b8; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª Add Card Modal Test</h1>
        <p>Test the add card confirmation modal functionality</p>
        
        <button class="test-btn" onclick="openAddCardModal()">ğŸ“„ Open Add Card Modal</button>
        <button class="test-btn" onclick="clearLog()">ğŸ—‘ï¸ Clear Log</button>
        
        <h3>ğŸ“‹ Console Log:</h3>
        <div id="log"></div>
    </div>

    <div id="modalContainer"></div>

    <script>
        // Console logging override
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;

        function addLogEntry(message, type = 'info') {
            const log = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        console.log = function(...args) {
            addLogEntry(args.join(' '), 'info');
            originalLog.apply(console, args);
        };

        console.error = function(...args) {
            addLogEntry(args.join(' '), 'error');
            originalError.apply(console, args);
        };

        console.warn = function(...args) {
            addLogEntry(args.join(' '), 'error');
            originalWarn.apply(console, args);
        };

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        function openAddCardModal() {
            console.log('ğŸš€ Loading add card modal...');
            
            fetch('./modals/addCard.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.text();
                })
                .then(html => {
                    console.log('âœ… Modal HTML loaded successfully');
                    document.getElementById('modalContainer').innerHTML = html;
                    
                    // Wait for modal to initialize
                    setTimeout(() => {
                        const modal = document.querySelector('.modal-overlay');
                        if (modal) {
                            modal.classList.add('active');
                            console.log('âœ… Modal activated');
                            
                            // Check if form exists
                            const form = modal.querySelector('#addCardForm');
                            if (form) {
                                console.log('âœ… Form found');
                                
                                // Check critical elements
                                const cardCategory = form.querySelector('#cardCategory');
                                const submitBtn = form.querySelector('.addButton');
                                const cancelBtn = form.querySelector('.cancelButton');
                                
                                console.log(`ğŸ“‹ Card category selector: ${cardCategory ? 'âœ…' : 'âŒ'}`);
                                console.log(`ğŸ“‹ Submit button: ${submitBtn ? 'âœ…' : 'âŒ'}`);
                                console.log(`ğŸ“‹ Cancel button: ${cancelBtn ? 'âœ…' : 'âŒ'}`);
                                
                                // Test form submission handler
                                if (form.onsubmit || form.addEventListener) {
                                    console.log('âœ… Form has submit handler');
                                } else {
                                    console.log('âŒ Form missing submit handler');
                                }
                                
                            } else {
                                console.log('âŒ Form not found in modal');
                            }
                        } else {
                            console.log('âŒ Modal overlay not found');
                        }
                    }, 100);
                })
                .catch(error => {
                    console.error('âŒ Failed to load modal:', error.message);
                });
        }

        // Initialize
        console.log('ğŸ¯ Add Card Modal Test Ready');
    </script>
</body>
</html>
